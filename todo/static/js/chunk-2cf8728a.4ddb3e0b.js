(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cf8728a"],{"260c":function(e,t,n){},3829:function(e,t,n){"use strict";var r=n("260c"),a=n.n(r);a.a},9807:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h-page",{attrs:{title:"计划详情","left-arrow":"",padding:"0"},on:{"click-left":e.handleJumpToAll,"click-right":e.handleShowMenu}},[n("svg-icon",{attrs:{slot:"top-right","icon-class":"more"},slot:"top-right"}),e._v(" "),e.item?n("div",{staticClass:"container"},[n("div",{staticClass:"top"},[n("div",{staticClass:"title"},[e._v("\n          "+e._s(e._f("filterTitle")(e.item))+"\n        ")]),e._v(" "),n("div",{staticClass:"date"},[n("span",[e._v("\n            开始时间: "+e._s(e._f("filterTime")(e.item.create_time))+"\n          ")]),e._v(" "),e.item.active?e._e():n("span",[e._v("\n            结束时间: "+e._s(e._f("filterTime")(e.item.finish_time))+"\n          ")])]),e._v(" "),n("div",{staticClass:"status"},[e._v("\n          "+e._s(e.item.active?"进行中":"已结束")+"\n        ")])]),e._v(" "),n("div",{staticClass:"main"},[n("Daily",{attrs:{planingId:e.item.id}})],1),e._v(" "),n("van-action-sheet",{attrs:{actions:[{name:e.item.active?"编辑计划":"重新发布",action:"edit"}].concat(e.item.active?{name:"结束计划",action:"stop"}:{name:"删除计划",action:"delete"})},on:{select:e.onSelect},model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}})],1):e._e()],1)],1)},a=[],i=(n("96cf"),n("3b8d")),s=n("7618"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,function(t,r){return n("van-cell",{key:t.id,style:{backgroundColor:r%2===1&&"#f2f6fa"},on:{click:function(n){return e.handleClick(t)}}},[n("div",{staticClass:"daily-item"},[n("div",{staticClass:"left"},[n("div",{staticClass:"time"},[e._v(e._s(e._f("filterTime")(t.create_time)))]),e._v(" "),n("div",{staticClass:"complete"},[e._v("完成量 "+e._s(t.complete_task||0)+" "+e._s(t.task_name))])]),e._v(" "),n("div",{staticClass:"right"},[n("div",{staticClass:"status",style:{color:e.getStatusColor(t)}},[e._v("\n          "+e._s(e.getStatusText(t))+"\n        ")])])])])}),1)},c=[],o=n("75fc"),l=(n("c5f6"),n("08f3")),p=n("d7ff"),d={props:{planingId:[Number]},computed:{},data:function(){return{list:[],loading:!1,finished:!1,planTypeIcon:l["b"],queryOptions:{page:0,count:20}}},methods:{getComplete:function(e){return parseFloat(e["complete_task"]||0)>=parseFloat(e["daily_task"]||0)+parseFloat(e["old_task"]||0)},getStatusColor:function(e){return this.getComplete(e)?"#1890FF":"#F75050"},getStatusText:function(e){return this.getComplete(e)?"已完成":"未完成"},handleClick:function(e){this.$router.push({name:"planDetail",params:{item:e}})},onLoad:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p["a"].getDaily(this.planingId,this.queryOptions);case 2:n=e.sent,(t=this.list).push.apply(t,Object(o["a"])(n.collection)),this.loading=!1,this.list.length>=n.total_nums||this.queryOptions.count>=n.total_nums?this.finished=!0:this.queryOptions.page++;case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},h=d,f=(n("3829"),n("2877")),m=Object(f["a"])(h,u,c,!1,null,"7aec728a",null),v=m.exports,g=n("3fa5"),b=n("d8ad"),w={components:{Daily:v},mounted:function(){},watch:{"$route.params.id":{handler:function(e){if(e){var t=this.$route.params;t&&t.item&&"object"===Object(s["a"])(t.item)?this.item=t.item:this.$router.push({name:"today"})}},immediate:!0}},data:function(){return{item:null,showMenu:!1}},methods:{handleJumpToAll:function(){this.$router.push({name:"all"})},handleShowMenu:function(){this.showMenu=!0},onSelect:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.showMenu=!1,"edit"!==t.action){e.next=5;break}this.handleEdit(),e.next=13;break;case 5:if("stop"!==t.action){e.next=10;break}return e.next=8,this.handleStop();case 8:e.next=13;break;case 10:if("delete"!==t.action){e.next=13;break}return e.next=13,this.handleDelete();case 13:this.show=!1;case 14:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),handleStop:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(g["a"])("确定要结束本计划吗？");case 2:if(t=e.sent,!t){e.next=9;break}return e.next=6,p["a"].stopPlaning(this.item.id);case 6:this.item.active=0,b["a"].$emit("stop",this.item),this.handleJumpToAll();case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleDelete:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(g["a"])("确定要删除本计划吗？");case 2:if(t=e.sent,!t){e.next=8;break}return e.next=6,p["a"].delectPlaning(this.item.id);case 6:b["a"].$emit("delete",this.item),this.handleJumpToAll();case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleEdit:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$router.push({name:"editing",params:{item:this.item}});case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},_=w,y=(n("9e66"),Object(f["a"])(_,r,a,!1,null,"784df0be",null));t["default"]=y.exports},"9e66":function(e,t,n){"use strict";var r=n("f0b0"),a=n.n(r);a.a},c466:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n("a481"),n("6b54");var r=n("7618");function a(e,t){if(0===arguments.length)return null;var n,a=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(r["a"])(e)?n=e:("string"===typeof e&&/^[0-9]+$/.test(e)&&(e=parseInt(e)),"number"===typeof e&&10===e.toString().length&&(e*=1e3),n=new Date(e));var i={y:n.getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()},s=a.replace(/{(y|m|d|h|i|s|a)+}/g,function(e,t){var n=i[t];return"a"===t?["日","一","二","三","四","五","六"][n]:(e.length>0&&n<10&&(n="0"+n),n||0)});return s}},d7ff:function(e,t,n){"use strict";var r=n("cebc"),a=(n("96cf"),n("3b8d")),i=n("d225"),s=n("b0b4"),u=n("be3b"),c=n("4360"),o=n("c466"),l=function(){function e(){Object(i["a"])(this,e)}return Object(s["a"])(e,[{key:"addPlaning",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log(c["a"].state.user,"store.state.user"),e.next=3,Object(u["c"])("v1/planing/",Object(r["a"])({},t,{active:1,user_id:c["a"].state.user.id}));case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"editPlaning",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t,n){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["d"])("v1/planing/".concat(t),Object(r["a"])({},n,{active:1,user_id:c["a"].state.user.id}));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"stopPlaning",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["d"])("v1/planing/".concat(t),{active:0,user_id:c["a"].state.user.id,finish_time:Object(o["a"])(new Date,"{y}-{m}-{d}")});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"delectPlaning",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["a"])("v1/planing/".concat(t),{user_id:c["a"].state.user.id});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getPlanings",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["b"])("v1/planing",Object(r["a"])({},t,{user_id:c["a"].state.user.id}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getPlaning",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["b"])("v1/planing/".concat(t),{user_id:c["a"].state.user.id});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getToday",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["b"])("v1/planing/today/",{user_id:c["a"].state.user.id});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getDaily",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t,n){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["b"])("v1/planing/".concat(t,"/daily"),Object(r["a"])({},n,{user_id:c["a"].state.user.id}));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setRecord",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t,n){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["d"])("v1/planing/".concat(t,"/record"),Object(r["a"])({},n,{user_id:c["a"].state.user.id}));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}()}]),e}();t["a"]=new l},f0b0:function(e,t,n){}}]);